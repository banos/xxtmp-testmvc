<template>
  <import from="behaviors/focus"></import>

  <header class="header">
    <h1>tobuys</h1>
    <input class="new-tobuy" placeholder="What needs to be done?" autofocus
           keyup.delegate="onKeyUp($event)"
           value.bind="newTodoTitle">
  </header>

  <section class="main" show.bind="items.length">
    <input class="toggle-all" type="checkbox" checked.bind="areAllChecked" change.delegate="onToggleAllChanged()">
    <label for="toggle-all">Mark all as complete</label>
    <ul class="tobuy-list">
      <li repeat.for="tobuyItem of filteredItems" class="${tobuyItem.isCompleted ? 'completed' : ''} ${tobuyItem.isEditing ? 'editing' : ''}">
        <div class="view">
          <input class="toggle" type="checkbox" checked.bind="tobuyItem.isCompleted">
          <label dblclick.delegate="tobuyItem.labelDoubleClicked()">${tobuyItem.title}</label>
          <button click.delegate="$parent.deleteTodo(tobuyItem)" class="destroy"></button>
        </div>
        <input class="edit"
               value.bind="tobuyItem.editTitle"
               focus.bind="tobuyItem.isEditing"
               focusout.delegate="tobuyItem.finishEditing($event)"
               keyup.delegate="tobuyItem.onKeyUp($event)">
      </li>
    </ul>
  </section>

  <footer class="footer" show.bind="items.length">
    <span class="tobuy-count">
      <strong>${countTodosLeft}</strong>
      ${countTodosLeft == 1 ? 'item' : 'items'} left</span>
    <ul class="filters">
      <li>
        <a class="${filter == '!' ? 'selected' : ''}" href="#!/">All</a>
      </li>
      <li>
        <a class="${filter == 'active' ? 'selected' : ''}" href="#/active">Active</a>
      </li>
      <li>
        <a class="${filter == 'completed' ? 'selected' : ''}" href="#/completed">Completed</a>
      </li>
    </ul>
    <button class="clear-completed" click.delegate="clearCompletedTodos()" show.bind="countTodosLeft < items.length">Clear completed</button>
  </footer>
</template>
